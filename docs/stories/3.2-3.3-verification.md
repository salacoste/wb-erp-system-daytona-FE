# –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Stories 3.2 –∏ 3.3

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-21  
**Stories:** 3.2 (Key Metric Cards Display), 3.3 (Expense Breakdown Visualization)  
**–°—Ç–∞—Ç—É—Å:** Ready for Review

---

## üìä Story 3.2: Key Metric Cards Display

### Acceptance Criteria - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| AC | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|----|------------|--------|----------|
| 1 | Large metric card displays "Total Payable" with formatted currency (RUB) | ‚úÖ PASS | `MetricCard` —Å `title="–ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é –∑–∞ —Ç–æ–≤–∞—Ä"` –∏ `value={metrics?.totalPayable}` |
| 2 | Large metric card displays "Revenue" with formatted currency (RUB) | ‚úÖ PASS | `MetricCard` —Å `title="–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¢–æ–≤–∞—Ä"` –∏ `value={metrics?.revenue}` |
| 3 | Metric cards use appropriate color coding (Blue for primary metrics) | ‚úÖ PASS | `text-blue-600` (#2563EB) - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é |
| 4 | Values formatted using Intl.NumberFormat with locale 'ru-RU' and currency 'RUB' | ‚úÖ PASS | `formatCurrency()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'RUB' })` |
| 5 | Metric cards prominently displayed and easily readable | ‚úÖ PASS | `text-4xl font-bold` (36px) - –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 32-48px |
| 6 | Data loads from backend API with proper authentication | ‚úÖ PASS | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `apiClient` —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ |
| 7 | Loading states are shown while data is being fetched | ‚úÖ PASS | `Skeleton` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ `isLoading` |
| 8 | Error states display appropriate messages if data cannot be loaded | ‚úÖ PASS | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π –ø–æ–≤—Ç–æ—Ä–∞ |
| 9 | Values update when data changes | ‚úÖ PASS | `refetchOnWindowFocus: true` –≤ TanStack Query |
| 10 | Cards are responsive and maintain readability | ‚úÖ PASS | Grid layout: `md:grid-cols-2 lg:grid-cols-2` |

**–í—Å–µ 10 Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã** ‚úÖ

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Backend

#### –î–∞–Ω–Ω—ã–µ –≤ –ë–î –¥–ª—è –Ω–µ–¥–µ–ª–∏ 2025-W46:

| –ü–æ–ª–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –ë–î | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|------|----------------|----------|
| `sale_gross_total` | 0.00 | `weekly_payout_total` |
| `to_pay_goods_total` | 195470.62 | `weekly_payout_total` |
| `payout_total` | 229086.83 | `weekly_payout_total` |

#### –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ API:

**Endpoint:** `/v1/analytics/weekly/finance-summary?week=2025-W46`

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**
```json
{
  "summary_total": {
    "week": "2025-W46",
    "sale_gross_total": 0.00,
    "to_pay_goods_total": 195470.62,
    "payout_total": 229086.83,
    // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
  },
  "summary_rus": { ... },
  "summary_eaeu": { ... },
  "meta": { ... }
}
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–¥–µ:

**–§–∞–π–ª:** `src/hooks/useDashboard.ts`

```typescript
// –°—Ç—Ä–æ–∫–∞ 77: –ò—Å–ø–æ–ª—å–∑—É–µ–º summary_total –∏–ª–∏ fallback –Ω–∞ summary_rus
const summary = summaryResponse.summary_total || summaryResponse.summary_rus

// –°—Ç—Ä–æ–∫–∞ 101-102: –ò–∑–≤–ª–µ–∫–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –æ–±–æ–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
const totalPayable = summary.to_pay_goods_total ?? summary.to_pay_goods
const revenue = summary.sale_gross_total ?? summary.sale_gross
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `summary_total` (–∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª–µ–π —Å `_total` –∏ –±–µ–∑ (legacy)
- ‚úÖ Fallback –Ω–∞ `summary_rus` –µ—Å–ª–∏ `summary_total` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ: `to_pay_goods_total: 195470.62`, `sale_gross_total: 0.00`

#### –û–∂–∏–¥–∞–µ–º–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:

- **"–ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é –∑–∞ —Ç–æ–≤–∞—Ä":** `195 470,62 ‚ÇΩ` ‚úÖ
- **"–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¢–æ–≤–∞—Ä":** `0,00 ‚ÇΩ` ‚úÖ (–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–µ –æ—à–∏–±–∫–∞)

---

## üìä Story 3.3: Expense Breakdown Visualization

### Acceptance Criteria - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

| AC | –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
|----|------------|--------|----------|
| 1 | Expense breakdown chart/graph displays on dashboard | ‚úÖ PASS | `ExpenseChart` –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `dashboard/page.tsx:123` |
| 2 | Visualization shows different expense categories | ‚úÖ PASS | –ö–∞—Ç–µ–≥–æ—Ä–∏–∏: –õ–æ–≥–∏—Å—Ç–∏–∫–∞, –•—Ä–∞–Ω–µ–Ω–∏–µ, –®—Ç—Ä–∞—Ñ—ã, –ö–æ–º–∏—Å—Å–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ |
| 3 | Chart uses appropriate visualization type | ‚úÖ PASS | Bar chart (Recharts `BarChart`) |
| 4 | Values formatted as currency (RUB) using Intl.NumberFormat | ‚úÖ PASS | `formatCurrency()` –≤ tooltip –∏ YAxis |
| 5 | Chart is interactive (tooltips on hover) | ‚úÖ PASS | `CustomTooltip` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é, —Å—É–º–º—É, –ø—Ä–æ—Ü–µ–Ω—Ç |
| 6 | Data loads from backend API endpoint | ‚úÖ PASS | `useExpenses` hook –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/v1/analytics/weekly/finance-summary` |
| 7 | Loading state is shown during data fetch | ‚úÖ PASS | `Skeleton` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø—Ä–∏ `isLoading` |
| 8 | Error handling displays message if data unavailable | ‚úÖ PASS | –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –∏ –∫–Ω–æ–ø–∫–æ–π –ø–æ–≤—Ç–æ—Ä–∞ |
| 9 | Chart is responsive and maintains readability | ‚úÖ PASS | `ResponsiveContainer` –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç `BarChart` |
| 10 | Color coding follows established patterns | ‚úÖ PASS | –ü–∞–ª–∏—Ç—Ä–∞: Blue, Green, Red, Orange, Purple |

**–í—Å–µ 10 Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã** ‚úÖ

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç Backend

#### –î–∞–Ω–Ω—ã–µ –≤ –ë–î –¥–ª—è –Ω–µ–¥–µ–ª–∏ 2025-W46:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ü–æ–ª–µ –≤ –ë–î | –ó–Ω–∞—á–µ–Ω–∏–µ –≤ –ë–î | –î–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è |
|-----------|-----------|---------------|---------------------|
| –õ–æ–≥–∏—Å—Ç–∏–∫–∞ | `logistics_cost_total` | 32470.10 | ‚úÖ 32 470,10 ‚ÇΩ |
| –•—Ä–∞–Ω–µ–Ω–∏–µ | `storage_cost_total` | 1849.69 | ‚úÖ 1 849,69 ‚ÇΩ |
| –®—Ç—Ä–∞—Ñ—ã | `penalties_total` | 0.00 | ‚ùå –ù–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è (—Ñ–∏–ª—å—Ç—Ä `amount > 0`) |
| –ö–æ–º–∏—Å—Å–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏ | `loyalty_fee_total` | 0.00 | ‚ùå –ù–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è (—Ñ–∏–ª—å—Ç—Ä `amount > 0`) |

**–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–∞—Å—Ö–æ–¥—ã –≤ chart:** 2 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–õ–æ–≥–∏—Å—Ç–∏–∫–∞, –•—Ä–∞–Ω–µ–Ω–∏–µ)  
**–û–∂–∏–¥–∞–µ–º—ã–π total:** 32470.10 + 1849.69 = 34319.79

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–¥–µ:

**–§–∞–π–ª:** `src/hooks/useExpenses.ts`

```typescript
// –°—Ç—Ä–æ–∫–∏ 78-95: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ä–∞—Å—Ö–æ–¥–æ–≤
const expenses: ExpenseItem[] = [
  {
    category: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞',
    amount: summary.logistics_cost_total ?? summary.logistics_cost ?? 0,
  },
  {
    category: '–•—Ä–∞–Ω–µ–Ω–∏–µ',
    amount: summary.storage_cost_total ?? summary.storage_cost ?? 0,
  },
  {
    category: '–®—Ç—Ä–∞—Ñ—ã',
    amount: summary.penalties_total ?? 0,
  },
  {
    category: '–ö–æ–º–∏—Å—Å–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏',
    amount: summary.loyalty_fee_total ?? summary.loyalty_fee ?? 0,
  },
].filter((item) => item.amount > 0) // –§–∏–ª—å—Ç—Ä –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `summary_total` (–∫–æ–Ω—Å–æ–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–ª–µ–π —Å `_total` –∏ –±–µ–∑ (legacy)
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (`amount > 0`)
- ‚úÖ –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑ –ë–î

#### –û–∂–∏–¥–∞–µ–º–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:

**Chart –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å:**
- **–õ–æ–≥–∏—Å—Ç–∏–∫–∞:** 32 470,10 ‚ÇΩ (94.6% –æ—Ç total)
- **–•—Ä–∞–Ω–µ–Ω–∏–µ:** 1 849,69 ‚ÇΩ (5.4% –æ—Ç total)
- **Total:** 34 319,79 ‚ÇΩ

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏:**
- –õ–æ–≥ `[Expenses] Found 2 expense categories with total: 34319.79` ‚úÖ

---

## üîç –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –¥–∞–Ω–Ω—ã—Ö

### Story 3.2: –ú–µ—Ç—Ä–∏–∫–∏

#### –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î (2025-W46):
```sql
sale_gross_total: 0.00
to_pay_goods_total: 195470.62
```

#### –û–∂–∏–¥–∞–µ–º–æ–µ –≤ API:
```json
{
  "summary_total": {
    "sale_gross_total": 0.00,
    "to_pay_goods_total": 195470.62
  }
}
```

#### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:
```typescript
const summary = summaryResponse.summary_total || summaryResponse.summary_rus
const totalPayable = summary.to_pay_goods_total ?? summary.to_pay_goods  // ‚Üí 195470.62 ‚úÖ
const revenue = summary.sale_gross_total ?? summary.sale_gross           // ‚Üí 0.00 ‚úÖ
```

#### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
- `MetricCard` –ø–æ–ª—É—á–∞–µ—Ç `value={metrics?.totalPayable}` ‚Üí `195470.62`
- `formatCurrency(195470.62)` ‚Üí `"195 470,62 ‚ÇΩ"` ‚úÖ
- `MetricCard` –ø–æ–ª—É—á–∞–µ—Ç `value={metrics?.revenue}` ‚Üí `0`
- `formatCurrency(0)` ‚Üí `"0,00 ‚ÇΩ"` ‚úÖ (–Ω–µ "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö", —Ç.–∫. `0 !== undefined`)

**‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è**

---

### Story 3.3: –†–∞—Å—Ö–æ–¥—ã

#### –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î (2025-W46):
```sql
logistics_cost_total: 32470.10
storage_cost_total: 1849.69
penalties_total: 0.00
loyalty_fee_total: 0.00
```

#### –û–∂–∏–¥–∞–µ–º–æ–µ –≤ API:
```json
{
  "summary_total": {
    "logistics_cost_total": 32470.10,
    "storage_cost_total": 1849.69,
    "penalties_total": 0.00,
    "loyalty_fee_total": 0.00
  }
}
```

#### –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:
```typescript
const expenses: ExpenseItem[] = [
  { category: '–õ–æ–≥–∏—Å—Ç–∏–∫–∞', amount: summary.logistics_cost_total ?? 0 },      // ‚Üí 32470.10 ‚úÖ
  { category: '–•—Ä–∞–Ω–µ–Ω–∏–µ', amount: summary.storage_cost_total ?? 0 },          // ‚Üí 1849.69 ‚úÖ
  { category: '–®—Ç—Ä–∞—Ñ—ã', amount: summary.penalties_total ?? 0 },               // ‚Üí 0.00 ‚Üí —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è ‚úÖ
  { category: '–ö–æ–º–∏—Å—Å–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏', amount: summary.loyalty_fee_total ?? 0 }, // ‚Üí 0.00 ‚Üí —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è ‚úÖ
].filter((item) => item.amount > 0) // –û—Å—Ç–∞–µ—Ç—Å—è 2 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ ‚úÖ
```

#### –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤:
```typescript
const total = expenses.reduce((sum, item) => sum + item.amount, 0) // ‚Üí 34319.79 ‚úÖ
const expensesWithPercentage = expenses.map((item) => ({
  ...item,
  percentage: total > 0 ? (item.amount / total) * 100 : 0
}))
// –õ–æ–≥–∏—Å—Ç–∏–∫–∞: (32470.10 / 34319.79) * 100 = 94.6% ‚úÖ
// –•—Ä–∞–Ω–µ–Ω–∏–µ: (1849.69 / 34319.79) * 100 = 5.4% ‚úÖ
```

#### –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ:
- Chart –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç 2 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–õ–æ–≥–∏—Å—Ç–∏–∫–∞, –•—Ä–∞–Ω–µ–Ω–∏–µ) ‚úÖ
- Tooltip –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—É–º–º—É –∏ –ø—Ä–æ—Ü–µ–Ω—Ç ‚úÖ
- YAxis —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ –≤–∞–ª—é—Ç–∞ ‚úÖ

**‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è, —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è**

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

### Story 3.2: Key Metric Cards Display

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–ª—É—á–∞—é—Ç—Å—è –æ—Ç backend
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π (`to_pay_goods_total`, `sale_gross_total`)
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ `revenue: 0` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (–Ω–µ –∫–∞–∫ –æ—à–∏–±–∫–∞)
- ‚úÖ –í—Å–µ 10 Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ë–î:**
- ‚úÖ `totalPayable: 195470.62` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ë–î `to_pay_goods_total: 195470.62`
- ‚úÖ `revenue: 0` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ë–î `sale_gross_total: 0.00`

---

### Story 3.3: Expense Breakdown Visualization

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£**

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–ª—É—á–∞—é—Ç—Å—è –æ—Ç backend
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω—É–ª–µ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
- ‚úÖ –í—Å–µ 10 Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

**–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ë–î:**
- ‚úÖ –õ–æ–≥–∏—Å—Ç–∏–∫–∞: 32470.10 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ë–î `logistics_cost_total: 32470.10`
- ‚úÖ –•—Ä–∞–Ω–µ–Ω–∏–µ: 1849.69 —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ë–î `storage_cost_total: 1849.69`
- ‚úÖ –®—Ç—Ä–∞—Ñ—ã –∏ –ö–æ–º–∏—Å—Å–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏: 0.00 –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –£–±—Ä–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è, —á—Ç–æ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –º–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- `console.info` –≤ `useDashboard.ts` (—Å—Ç—Ä–æ–∫–∏ 59, 64, 91-99, 105-112)
- `console.info` –≤ `useExpenses.ts` (—Å—Ç—Ä–æ–∫–∏ 45, 50, 105)
- `console.info` –≤ `dashboard/page.tsx` (—Å—Ç—Ä–æ–∫–∏ 25-31)

–ò–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ—à–∏–±–∫–∏).

### 2. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é stories

Stories 3.2 –∏ 3.3 —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ Story 2.7 –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö endpoint'–∞—Ö.

### 3. –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

1. –û—Ç–∫—Ä–æ–π—Ç–µ dashboard
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:
   - "–ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é –∑–∞ —Ç–æ–≤–∞—Ä": –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `195 470,62 ‚ÇΩ`
   - "–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¢–æ–≤–∞—Ä": –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `0,00 ‚ÇΩ`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ chart —Ä–∞—Å—Ö–æ–¥–æ–≤:
   - –î–æ–ª–∂–Ω—ã –±—ã—Ç—å 2 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –õ–æ–≥–∏—Å—Ç–∏–∫–∞ –∏ –•—Ä–∞–Ω–µ–Ω–∏–µ
   - –°—É–º–º—ã –¥–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –ë–î

---

## ‚úÖ –í—ã–≤–æ–¥—ã

**–û–±–µ stories (3.2 –∏ 3.3) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**

1. ‚úÖ –í—Å–µ Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
2. ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–ª—É—á–∞—é—Ç—Å—è –æ—Ç backend
3. ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–º –≤ –ë–î
4. ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º
5. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø—É—Å—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞
6. ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
7. ‚úÖ –ö–æ–¥ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º –ø—Ä–æ–µ–∫—Ç–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **READY FOR DONE** - –û–±–µ stories –≥–æ—Ç–æ–≤—ã –∫ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Å–ª–µ QA review.

---

## üîç –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –ë–î –∏ API

### –î–∞–Ω–Ω—ã–µ –∏–∑ –ë–î (2025-W46):

```sql
sale_gross_total: 0.00
to_pay_goods_total: 195470.62
logistics_cost_total: 32470.10
storage_cost_total: 1849.69
penalties_total: 0.00
loyalty_fee_total: 0.00
total_expenses: 34319.79
```

### –û–∂–∏–¥–∞–µ–º–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ UI:

**Story 3.2 - Metric Cards:**
- "–ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—é –∑–∞ —Ç–æ–≤–∞—Ä": `195 470,62 ‚ÇΩ` ‚úÖ
- "–í–∞–π–ª–¥–±–µ—Ä—Ä–∏–∑ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª –¢–æ–≤–∞—Ä": `0,00 ‚ÇΩ` ‚úÖ

**Story 3.3 - Expense Chart:**
- –õ–æ–≥–∏—Å—Ç–∏–∫–∞: `32 470,10 ‚ÇΩ` (94.6%) ‚úÖ
- –•—Ä–∞–Ω–µ–Ω–∏–µ: `1 849,69 ‚ÇΩ` (5.4%) ‚úÖ
- Total: `34 319,79 ‚ÇΩ` ‚úÖ
- –®—Ç—Ä–∞—Ñ—ã –∏ –ö–æ–º–∏—Å—Å–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏: –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è (—Ñ–∏–ª—å—Ç—Ä `amount > 0`) ‚úÖ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**
```
[Dashboard Metrics] Fetching finance summary for week: 2025-W46
[Dashboard Metrics] Finance summary received: { summary_type: 'summary_total', ... }
[Dashboard Metrics] Final values extracted: { totalPayable: 195470.62, revenue: 0, ... }
[Expenses] Fetching finance summary for week: 2025-W46
[Expenses] Found 2 expense categories with total: 34319.79
```

**–ï—Å–ª–∏ –ª–æ–≥–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç** ‚Üí ‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π –≤–µ—Ä–¥–∏–∫—Ç

### Story 3.2: Key Metric Cards Display

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **READY FOR DONE**

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ –í—Å–µ 10 Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–ª—É—á–∞—é—Ç—Å—è –æ—Ç backend
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ë–î (`to_pay_goods_total: 195470.62`, `sale_gross_total: 0.00`)
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (`Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'RUB' })`)
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ `0` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (–Ω–µ –∫–∞–∫ "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö")
- ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (9 tests)

---

### Story 3.3: Expense Breakdown Visualization

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **READY FOR DONE**

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ –í—Å–µ 10 Acceptance Criteria –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- ‚úÖ –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–ª—É—á–∞—é—Ç—Å—è –æ—Ç backend
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ë–î:
  - –õ–æ–≥–∏—Å—Ç–∏–∫–∞: 32470.10 ‚úÖ
  - –•—Ä–∞–Ω–µ–Ω–∏–µ: 1849.69 ‚úÖ
  - –®—Ç—Ä–∞—Ñ—ã: 0.00 (—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è) ‚úÖ
  - –ö–æ–º–∏—Å—Å–∏—è –ª–æ—è–ª—å–Ω–æ—Å—Ç–∏: 0.00 (—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è) ‚úÖ
- ‚úÖ –†–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω (94.6% –∏ 5.4%)
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (15 tests)

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–û–±–µ stories –≥–æ—Ç–æ–≤—ã –∫ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏–∏** - –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
2. **–î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã** - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ë–î –∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. **–ú–æ–∂–Ω–æ —É–±—Ä–∞—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ø–æ—Å–ª–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
4. **QA review –º–æ–∂–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å** - –æ–±–µ stories –≥–æ—Ç–æ–≤—ã –∫ —Å—Ç–∞—Ç—É—Å—É "Done"

---

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-21  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** Dev Agent (Auto)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **VERIFIED** - –û–±–µ stories —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –¥–∞–Ω–Ω—ã–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ë–î

