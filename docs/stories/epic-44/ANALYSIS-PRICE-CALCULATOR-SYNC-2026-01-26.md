# –ê–Ω–∞–ª–∏–∑: Price Calculator - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Backend
**–î–∞—Ç–∞**: 2026-01-26
**Epic**: 44-FE (Price Calculator UI)
**–°—Ç–∞—Ç—É—Å**: üîç –ê–ù–ê–õ–ò–ó

---

## üìä –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Backend

### 1. SUPPLY System –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –†–ï–ê–õ–¨–ù–´–ï —Ç–∞—Ä–∏—Ñ—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è!

**–ò–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –±—ç–∫–µ–Ω–¥–∞** (—Ä–µ–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç 2026-01-27):
```json
{
  "warehouseId": 130744,
  "warehouseName": "–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä (–¢–∏—Ö–æ—Ä–µ—Ü–∫–∞—è)",
  "boxTypeId": 5,
  "boxTypeName": "Pallets",
  "delivery": {
    "coefficient": 1.65,
    "baseLiterRub": 75,
    "additionalLiterRub": 23
  },
  "storage": {
    "coefficient": 1.65,
    "baseLiterRub": 41.25,      ‚Üê –ù–ï 0!
    "additionalLiterRub": 0      ‚Üê –î–ª—è Pallets = 0
  }
}
```

**–ß—Ç–æ –º—ã –≤–∏–¥–µ–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:**
```
storage: {
  baseLiterRub: 0        ‚Üê –ü—Ä–∏—Ö–æ–¥–∏—Ç 0!
  additionalLiterRub: 0
  coefficient: 1.65
}
```

**–í—ã–≤–æ–¥**: –õ–∏–±–æ –±—ç–∫–µ–Ω–¥ –±—ã–ª –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ –Ω–∞—à–µ–≥–æ —Ç–µ—Å—Ç–∞, –ª–∏–±–æ –º—ã —Å–º–æ—Ç—Ä–µ–ª–∏ –Ω–∞ –¥—Ä—É–≥–æ–π `boxTypeId`.

---

### 2. Box Types - –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!

| boxTypeId | –ù–∞–∑–≤–∞–Ω–∏–µ | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ storage |
|-----------|----------|---------------------|
| **2** | Boxes (–ö–æ—Ä–æ–±–∫–∏) | –û–±—ã—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç |
| **5** | Pallets (–ú–æ–Ω–æ–ø–∞–ª–ª–µ—Ç—ã) | `additionalLiterRub = 0` (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞–≤–∫–∞) |
| **6** | Supersafe (–°—É–ø–µ—Ä—Å–µ–π—Ñ) | –û–±—ã—á–Ω—ã–π —Ä–∞—Å—á–µ—Ç |

**‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê**: –ú—ã —Ñ–∏–ª—å—Ç—Ä—É–µ–º –ø–æ `boxTypeId: 2` (Boxes), –Ω–æ –¥–ª—è Pallets —Ñ–æ—Ä–º—É–ª–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è!

---

### 3. –§–æ—Ä–º—É–ª—ã —Ä–∞—Å—á–µ—Ç–∞ (–û–ë–ù–û–í–õ–ï–ù–ù–´–ï)

**–õ–æ–≥–∏—Å—Ç–∏–∫–∞:**
```typescript
logistics = (baseLiterRub + max(0, volume-1) √ó additionalLiterRub) √ó deliveryCoef
```

**–•—Ä–∞–Ω–µ–Ω–∏–µ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ):**
```typescript
dailyStorage = (baseLiterRub + max(0, volume-1) √ó additionalLiterRub) √ó storageCoef
```

**–•—Ä–∞–Ω–µ–Ω–∏–µ (–∏—Ç–æ–≥–æ):**
```typescript
storage = dailyStorage √ó days
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Pallets (1 –ª–∏—Ç—Ä, 30 –¥–Ω–µ–π):**
- –õ–æ–≥–∏—Å—Ç–∏–∫–∞: `(75 + 0 √ó 23) √ó 1.65 = 123.75 ‚ÇΩ`
- –•—Ä–∞–Ω–µ–Ω–∏–µ/–¥–µ–Ω—å: `(41.25 + 0 √ó 0) √ó 1.65 = 68.06 ‚ÇΩ`
- –•—Ä–∞–Ω–µ–Ω–∏–µ (30 –¥–Ω–µ–π): `68.06 √ó 30 = 2041.80 ‚ÇΩ`
- **–ò–¢–û–ì–û: 2165.55 ‚ÇΩ**

---

### 4. Warehouse ID Mapping

| Warehouse Name | INVENTORY ID | SUPPLY ID |
|----------------|--------------|-----------|
| –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä | 507 | 130744 |
| –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä (–¢–∏—Ö–æ—Ä–µ—Ü–∫–∞—è) | - | 130744 |
| –ö–æ–ª–µ–¥–∏–Ω–æ | 117686 | 117686 |
| –≠–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–ª—å | 117825 | 117825 |

**‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û**: –ú—ã –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ SUPPLY warehouses.

---

## üî¥ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è Frontend vs Backend

### 1. Storage —Ç–∞—Ä–∏—Ñ—ã = 0 (–ö–†–ò–¢–ò–ß–ù–û)
**–°–∏–º–ø—Ç–æ–º**: UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "0.00 ‚ÇΩ/–¥–µ–Ω—å" –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
**–ü—Ä–∏—á–∏–Ω–∞**: Backend API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `storage.baseLiterRub: 0` –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π
**–ù–∞—à —Ç–µ–∫—É—â–∏–π fix**: Fallback –Ω–∞ DEFAULT_TARIFFS (0.07/0.05)
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á–µ–º—É backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (41.25)

### 2. Box Type –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ UI
**–°–∏–º–ø—Ç–æ–º**: –ù–µ—Ç –≤—ã–±–æ—Ä–∞ —Ç–∏–ø–∞ —É–ø–∞–∫–æ–≤–∫–∏ (–ö–æ—Ä–æ–±–∫–∏/–ü–∞–ª–ª–µ—Ç—ã)
**–í–ª–∏—è–Ω–∏–µ**: –î–ª—è Pallets `additionalLiterRub = 0` - —Ñ–æ—Ä–º—É–ª–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä boxType –∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–∏–ø–µ

### 3. –§–æ—Ä–º—É–ª–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–µ—Ä–Ω–æ–π
**–¢–µ–∫—É—â–∞—è —Ñ–æ—Ä–º—É–ª–∞ (storage-cost-utils.ts)**:
```typescript
baseCost = basePerDayRub + additionalLiters * perLiterPerDayRub
return baseCost * coefficient
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ (–∏–∑ backend docs)**:
```typescript
dailyStorage = (baseLiterRub + max(0, volume-1) √ó additionalLiterRub) √ó storageCoef
```

**–†–∞–∑–Ω–∏—Ü–∞**: `max(0, volume-1)` vs `additionalLiters = volume - 1`
- –ù–∞—à–∞ —Ñ–æ—Ä–º—É–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å edge cases

### 4. –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏—ë–º–∫–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö
**Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç**: `coefficient: 1` (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏—ë–º–∫–∏)
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: `-1` = –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, `0` = –±–µ—Å–ø–ª–∞—Ç–Ω–æ, `‚â•1` = –º–Ω–æ–∂–∏—Ç–µ–ª—å
**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å**: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ UI, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤ —Ñ–æ—Ä–º—É–ª–∞—Ö

---

## üìã –ü–ª–∞–Ω —Ä–∞–±–æ—Ç

### –§–∞–∑–∞ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (—Å–µ–≥–æ–¥–Ω—è)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç backend API –¥–ª—è storage
- [ ] –°—Ä–∞–≤–Ω–∏—Ç—å –Ω–∞—à–∏ —Ñ–æ—Ä–º—É–ª—ã —Å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–µ–π
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å boxTypeId —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é

### –§–∞–∑–∞ 2: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (Priority P1)
- [ ] **Fix Storage = 0**: –í—ã—è—Å–Ω–∏—Ç—å –ø—Ä–∏—á–∏–Ω—É, –∏—Å–ø—Ä–∞–≤–∏—Ç—å
- [ ] **Verify Formulas**: –°—Ä–∞–≤–Ω–∏—Ç—å `storage-cost-utils.ts` —Å backend —Ñ–æ—Ä–º—É–ª–∞–º–∏
- [ ] **Box Type Handling**: –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É boxTypeId: 5 (Pallets)

### –§–∞–∑–∞ 3: –£–ª—É—á—à–µ–Ω–∏—è (Priority P2)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä Box Type –≤ UI (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- [ ] –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ø—Ä–∏—ë–º–∫–∏ –≤ UI
- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º—É–ª—ã –¥–ª—è Pallets (additionalLiterRub = 0)

---

## üîç –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—Ä–æ—Å–∏—Ç—å —É backend**: –ü–æ—á–µ–º—É storage.baseLiterRub = 0 –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π?
2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å boxTypeId**: –ö–∞–∫–æ–π boxTypeId –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –¥–ª—è –ö—Ä–∞—Å–Ω–æ–¥–∞—Ä (–¢–∏—Ö–æ—Ä–µ—Ü–∫–∞—è)?
3. **–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—É–ª—ã**: –°—Ä–∞–≤–Ω–∏—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ backend

---

**–ê–≤—Ç–æ—Ä**: Frontend Team
**–†–µ–≤—å—é–≤–µ—Ä**: Backend Team (–¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
