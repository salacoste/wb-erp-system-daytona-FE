# –ü—Ä–æ–±–ª–µ–º–∞: –û–∫–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–î–∞—Ç–∞:** 2025-11-21  
**Stories:** 3.2, 3.3  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** HIGH

---

## üîç –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã

### –°–∏–º–ø—Ç–æ–º—ã

- –û–∫–Ω–æ "–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º 0%
- –î–∞–Ω–Ω—ã–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã (–µ—Å—Ç—å –≤ `weekly_payout_total`)
- –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Ä–∞—Å—Ö–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –û–∫–Ω–æ –Ω–µ –∏—Å—á–µ–∑–∞–µ—Ç, —Ö–æ—Ç—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞

### –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞

**–§–∞–π–ª:** `src/app/(dashboard)/dashboard/page.tsx` (—Å—Ç—Ä–æ–∫–∏ 40-42)

```typescript
const isFinancialDataProcessing = 
  processingStatus?.reportLoading?.status === 'in_progress' ||
  processingStatus?.reportLoading?.status === 'pending'
```

**–§–∞–π–ª:** `src/hooks/useProcessingStatus.ts` (—Å—Ç—Ä–æ–∫–∏ 31-42)

```typescript
const reportLoading = {
  progress: financesTask?.progress ?? 0,
  status:
    financesTask?.status === 'completed'
      ? 'completed'
      : financesTask?.status === 'failed'
        ? 'failed'
        : financesTask?.status === 'in_progress'
          ? 'in_progress'
          : 'pending',  // ‚Üê –ü–†–û–ë–õ–ï–ú–ê: –ï—Å–ª–∏ –∑–∞–¥–∞—á–∏ –Ω–µ—Ç, —Å—Ç–∞—Ç—É—Å = 'pending'
  taskUuid: financesTask?.uuid,
}
```

### –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î –ø–æ–∫–∞–∑–∞–ª–∞:**
- –í —Ç–∞–±–ª–∏—Ü–µ `tasks` –¥–ª—è –∫–∞–±–∏–Ω–µ—Ç–∞ `f75836f7-c0bc-4b2c-823c-a1f3508cce8e` **–ù–ï–¢ –∑–∞–¥–∞—á —Ç–∏–ø–∞ `finances_weekly_ingest`**
- –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ `products_sync` (completed) –∏ `weekly_sanity_check` (pending/completed)
- –î–∞–Ω–Ω—ã–µ –≤ `weekly_payout_total` —É–∂–µ –µ—Å—Ç—å (16 –Ω–µ–¥–µ–ª—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ)

**–ü–æ—á–µ–º—É –∑–∞–¥–∞—á–∞ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è:**
1. –ó–∞–¥–∞—á–∞ `finances_weekly_ingest` –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å –≤–æ–æ–±—â–µ (–¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –¥—Ä—É–≥–∏–º –º–µ—Ö–∞–Ω–∏–∑–º–æ–º)
2. –ó–∞–¥–∞—á–∞ –±—ã–ª–∞ —É–¥–∞–ª–µ–Ω–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
3. –ó–∞–¥–∞—á–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ `limit=20` –≤ API –∑–∞–ø—Ä–æ—Å–µ
4. Backend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥—Ä—É–≥–æ–π —Ç–∏–ø –∑–∞–¥–∞—á–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–Ω–∞–Ω—Å–æ–≤

**–ü–æ—á–µ–º—É –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–∫–Ω–æ:**
- –ö–æ–≥–¥–∞ `financesTask` = `undefined`, —Å—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è `'pending'`
- Dashboard –≤–∏–¥–∏—Ç `reportLoading.status === 'pending'` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–∫–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –ù–æ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ API

---

## üìä –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞

### 1. Hook `useProcessingStatus`

**–§–∞–π–ª:** `src/hooks/useProcessingStatus.ts`

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –º–µ—Å—Ç–∞:**

1. **–°—Ç—Ä–æ–∫–∞ 88-91:** –ó–∞–ø—Ä–æ—Å –∑–∞–¥–∞—á —Å `limit=20`
   ```typescript
   const response = await apiClient.get<{
     items: Task[]
     next_cursor?: string
   }>('/v1/tasks?limit=20')
   ```
   - –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ —Å—Ç–∞—Ä–∞—è, –æ–Ω–∞ –º–æ–∂–µ—Ç –Ω–µ –ø–æ–ø–∞—Å—Ç—å –≤ –ø–µ—Ä–≤—ã–µ 20

2. **–°—Ç—Ä–æ–∫–∞ 94-98:** –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ —Ç–∏–ø—É `finances_weekly_ingest`
   ```typescript
   const relevantTasks = (response.items || []).filter(
     (task) =>
       task.type === 'products_sync' ||
       task.type === 'finances_weekly_ingest',
   )
   ```
   - –ï—Å–ª–∏ –∑–∞–¥–∞—á–∏ –Ω–µ—Ç –≤ –æ—Ç–≤–µ—Ç–µ, `financesTask` = `undefined`

3. **–°—Ç—Ä–æ–∫–∞ 31-42:** –°—Ç–∞—Ç—É—Å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `'pending'`
   ```typescript
   const reportLoading = {
     progress: financesTask?.progress ?? 0,
     status:
       financesTask?.status === 'completed'
         ? 'completed'
         : financesTask?.status === 'failed'
           ? 'failed'
           : financesTask?.status === 'in_progress'
             ? 'in_progress'
             : 'pending',  // ‚Üê –ü–†–û–ë–õ–ï–ú–ê
   }
   ```

### 2. Dashboard Page

**–§–∞–π–ª:** `src/app/(dashboard)/dashboard/page.tsx`

**–°—Ç—Ä–æ–∫–∏ 40-42:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```typescript
const isFinancialDataProcessing = 
  processingStatus?.reportLoading?.status === 'in_progress' ||
  processingStatus?.reportLoading?.status === 'pending'
```

**–°—Ç—Ä–æ–∫–∏ 56-71:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–∫–Ω–∞
```typescript
{isFinancialDataProcessing && (
  <Alert className="border-blue-500 bg-blue-50">
    {/* –û–∫–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ */}
  </Alert>
)}
```

---

## üí° –†–µ—à–µ–Ω–∏–µ

### –ü–æ–¥—Ö–æ–¥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–ò–¥–µ—è:** –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ API (`available-weeks` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–¥–µ–ª–∏), –∑–Ω–∞—á–∏—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞ –∑–∞–¥–∞—á–∏.

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ: –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞–ª–∏—á–∏—è –∑–∞–¥–∞—á–∏ –≤ –ë–î
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ –∑–∞–¥–∞—á–∏ —É–¥–∞–ª–µ–Ω—ã –∏–ª–∏ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

1. **–ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `dashboard/page.tsx`:**
   ```typescript
   // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ available-weeks
   const { data: availableWeeks } = useQuery({
     queryKey: ['dashboard', 'available-weeks'],
     queryFn: async () => {
       const response = await apiClient.get('/v1/analytics/weekly/available-weeks')
       return response.data || []
     },
     staleTime: 60000, // 1 minute
   })

   // –ï—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
   const hasFinancialData = availableWeeks && availableWeeks.length > 0
   
   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
   // 1. –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ò
   // 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∏–ª–∏ –æ–∂–∏–¥–∞–µ—Ç
   const isFinancialDataProcessing = 
     !hasFinancialData && (
       processingStatus?.reportLoading?.status === 'in_progress' ||
       processingStatus?.reportLoading?.status === 'pending'
     )
   ```

2. **–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ `useDashboardMetrics`:**
   ```typescript
   // –ï—Å–ª–∏ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –∑–Ω–∞—á–∏—Ç –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å
   const hasFinancialData = metrics && (metrics.totalPayable !== undefined || metrics.revenue !== undefined)
   
   const isFinancialDataProcessing = 
     !hasFinancialData && (
       processingStatus?.reportLoading?.status === 'in_progress' ||
       processingStatus?.reportLoading?.status === 'pending'
     )
   ```

### –ü–æ–¥—Ö–æ–¥ 2: –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `useProcessingStatus`

**–ò–¥–µ—è:** –ï—Å–ª–∏ –∑–∞–¥–∞—á–∏ –Ω–µ—Ç, –Ω–æ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã, —Å—á–∏—Ç–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

1. **–ò–∑–º–µ–Ω–∏—Ç—å `aggregateProcessingStatus` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö:**
   ```typescript
   async function aggregateProcessingStatus(
     tasks: Task[],
     hasFinancialData: boolean = false
   ): Promise<ProcessingStatus> {
     const financesTask = tasks.find((t) => t.type === 'finances_weekly_ingest')
     
     const reportLoading = {
       progress: financesTask?.progress ?? 0,
       status:
         financesTask?.status === 'completed'
           ? 'completed'
           : financesTask?.status === 'failed'
             ? 'failed'
             : financesTask?.status === 'in_progress'
               ? 'in_progress'
               : hasFinancialData  // ‚Üê –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –Ω–æ –∑–∞–¥–∞—á–∞ –µ—Å—Ç—å
                 ? 'completed'      // ‚Üê –°—á–∏—Ç–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π
                 : 'pending',       // ‚Üê –ò–Ω–∞—á–µ pending
       taskUuid: financesTask?.uuid,
     }
     // ...
   }
   ```

2. **–ò–∑–º–µ–Ω–∏—Ç—å `useProcessingStatus` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö:**
   ```typescript
   export function useProcessingStatus() {
     const { cabinetId } = useAuthStore()
     
     // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
     const { data: availableWeeks } = useQuery({
       queryKey: ['dashboard', 'available-weeks'],
       queryFn: async () => {
         const response = await apiClient.get('/v1/analytics/weekly/available-weeks')
         return response.data || []
       },
       enabled: !!cabinetId,
     })
     
     const hasFinancialData = availableWeeks && availableWeeks.length > 0
     
     return useQuery({
       queryKey: ['processing-status', cabinetId],
       queryFn: async (): Promise<ProcessingStatus> => {
         // ... –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–¥–∞—á
         return aggregateProcessingStatus(relevantTasks, hasFinancialData)
       },
       // ...
     })
   }
   ```

### –ü–æ–¥—Ö–æ–¥ 3: –£–≤–µ–ª–∏—á–∏—Ç—å limit –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–≥–∏–Ω–∞—Ü–∏—é

**–ò–¥–µ—è:** –£–≤–µ–ª–∏—á–∏—Ç—å `limit` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `next_cursor` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–¥–∞—á.

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ùå –ù–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É, –µ—Å–ª–∏ –∑–∞–¥–∞—á–∏ –≤–æ–æ–±—â–µ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∏—Å—å
- ‚ùå –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- ‚ùå –ù–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–ü–æ–¥—Ö–æ–¥ 1 + —É–ª—É—á—à–µ–Ω–∏—è)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. **–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã** (`available-weeks` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ–¥–µ–ª–∏) ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
2. **–ï—Å–ª–∏ –∑–∞–¥–∞—á–∏ –Ω–µ—Ç, –Ω–æ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç** ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ pending
3. **–ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –µ—Å—Ç—å** ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

1. **–ò–∑–º–µ–Ω–∏—Ç—å `dashboard/page.tsx`:**
   ```typescript
   // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ useDashboardMetrics –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
   const hasFinancialData = metrics && (
     metrics.totalPayable !== undefined || 
     metrics.revenue !== undefined
   )
   
   // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
   // 1. –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ò
   // 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∏–ª–∏ –æ–∂–∏–¥–∞–µ—Ç
   const isFinancialDataProcessing = 
     !hasFinancialData && (
       processingStatus?.reportLoading?.status === 'in_progress' ||
       processingStatus?.reportLoading?.status === 'pending'
     )
   ```

2. **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–ª—É—á—à–∏—Ç—å `useProcessingStatus` –¥–ª—è –±—É–¥—É—â–µ–≥–æ:**
   - –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö
   - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –∏ –∑–∞–¥–∞—á–∏ –Ω–µ—Ç ‚Üí pending
   - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å ‚Üí completed

---

## üìã –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –®–∞–≥ 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `dashboard/page.tsx`

**–§–∞–π–ª:** `src/app/(dashboard)/dashboard/page.tsx`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ `metrics`
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –æ–∫–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –ò –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ

**–ö–æ–¥:**
```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö
const hasFinancialData = metrics && (
  metrics.totalPayable !== undefined || 
  metrics.revenue !== undefined
)

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ò –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
const isFinancialDataProcessing = 
  !hasFinancialData && (
    processingStatus?.reportLoading?.status === 'in_progress' ||
    processingStatus?.reportLoading?.status === 'pending'
  )
```

### –®–∞–≥ 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π: –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –∑–∞–¥–∞—á–∏ –Ω–µ—Ç ‚Üí –æ–∫–Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π: –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∑–∞–¥–∞—á–∏ –Ω–µ—Ç ‚Üí –æ–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π: –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∑–∞–¥–∞—á–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ ‚Üí –æ–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π: –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Üí –æ–∫–Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ

### –®–∞–≥ 3: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. –£–ª—É—á—à–∏—Ç—å `useProcessingStatus` –¥–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –ª–æ–≥–∏–∫–∏
2. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

## üîß –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –§–∞–π–ª 1: `src/app/(dashboard)/dashboard/page.tsx`

**–°—Ç—Ä–æ–∫–∏ 39-44:** –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ë—ã–ª–æ:**
```typescript
const isFinancialDataProcessing = 
  processingStatus?.reportLoading?.status === 'in_progress' ||
  processingStatus?.reportLoading?.status === 'pending'
```

**–°—Ç–∞–Ω–µ—Ç:**
```typescript
// –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –º–µ—Ç—Ä–∏–∫–∏
// –ï—Å–ª–∏ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–¥–∞–∂–µ –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è 0), –∑–Ω–∞—á–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
const hasFinancialData = metrics !== undefined && (
  metrics.totalPayable !== undefined || 
  metrics.revenue !== undefined
)

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏:
// 1. –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö (–º–µ—Ç—Ä–∏–∫–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ undefined) –ò
// 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∏–ª–∏ –æ–∂–∏–¥–∞–µ—Ç
const isFinancialDataProcessing = 
  !hasFinancialData && (
    processingStatus?.reportLoading?.status === 'in_progress' ||
    processingStatus?.reportLoading?.status === 'pending'
  )
```

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ï—Å–ª–∏ `metrics` –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–¥–∞–∂–µ –µ—Å–ª–∏ `revenue: 0`), –∑–Ω–∞—á–∏—Ç API –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ
- –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- –û–∫–Ω–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã

---

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. **–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã:**
   - –ú–µ—Ç—Ä–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã ‚Üí `hasFinancialData = true`
   - –û–∫–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ **–Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è** ‚úÖ
   - –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Ä–∞—Å—Ö–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ ‚úÖ

2. **–ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã:**
   - –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã ‚Üí `hasFinancialData = false`
   - –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ ‚Üí –æ–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ
   - –ï—Å–ª–∏ –∑–∞–¥–∞—á–∏ –Ω–µ—Ç ‚Üí –æ–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ‚úÖ

3. **–ï—Å–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ:**
   - –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã ‚Üí `hasFinancialData = false`
   - –ó–∞–¥–∞—á–∞ `in_progress` ‚Üí –æ–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º ‚úÖ

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ü–æ—á–µ–º—É `metrics !== undefined` –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ

- `metrics` –º–æ–∂–µ—Ç –±—ã—Ç—å `{}` (–ø—É—Å—Ç–æ–π –æ–±—ä–µ–∫—Ç) –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–æ–ª–µ–π (`totalPayable`, `revenue`)

### –ü–æ—á–µ–º—É –ø—Ä–æ–≤–µ—Ä–∫–∞ `available-weeks` –ª—É—á—à–µ

- –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ—Ç—Ä–∏–∫
- –ù–æ —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

### –ö–æ–º–ø—Ä–æ–º–∏—Å—Å

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `metrics` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ (—É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã)
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `available-weeks`

---

**–î–∞—Ç–∞:** 2025-11-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** HIGH

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2025-11-21

### –ò–∑–º–µ–Ω–µ–Ω–∏—è

**–§–∞–π–ª:** `src/app/(dashboard)/dashboard/page.tsx`

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –º–µ—Ç—Ä–∏–∫–∏:**
```typescript
// Check if financial data is available through metrics
// If metrics are loaded (even if values are 0), it means data is processed
const hasFinancialData = metrics !== undefined && (
  metrics.totalPayable !== undefined || 
  metrics.revenue !== undefined
)

// Show processing window only if:
// 1. No data available (metrics not loaded or undefined) AND
// 2. Processing is in progress or pending
const isFinancialDataProcessing = 
  !hasFinancialData && (
    processingStatus?.reportLoading?.status === 'in_progress' ||
    processingStatus?.reportLoading?.status === 'pending'
  )
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç

- ‚úÖ –û–∫–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–µ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã–µ —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã
- ‚úÖ –û–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –ò –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
- ‚úÖ –õ–æ–≥–∏–∫–∞ –æ—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–º –Ω–∞–ª–∏—á–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç–∞—Ç—É—Å–µ –∑–∞–¥–∞—á–∏

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
1. ‚úÖ –î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –∑–∞–¥–∞—á–∏ –Ω–µ—Ç ‚Üí –æ–∫–Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
2. ‚úÖ –î–∞–Ω–Ω—ã–µ –µ—Å—Ç—å, –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ ‚Üí –æ–∫–Ω–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
3. ‚úÖ –î–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∑–∞–¥–∞—á–∞ –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ ‚Üí –æ–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
4. ‚úÖ –î–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∑–∞–¥–∞—á–∏ –Ω–µ—Ç ‚Üí –æ–∫–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (pending)

