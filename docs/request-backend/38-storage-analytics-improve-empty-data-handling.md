# Storage Analytics: –£–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—É—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## –ü—Ä–æ–±–ª–µ–º–∞

Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É "–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–µ–¥–µ–ª—è–º" –∫–æ–≥–¥–∞ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—É—Å—Ç—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è (empty states) —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

## –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

### 1. –ü—É—Å—Ç—ã–µ –ø–µ—Ä–∏–æ–¥—ã –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –ø—É—Å—Ç—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ —Ç–∞–±–ª–∏—Ü—ã —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –ü—Ä–µ–¥–ª–∞–≥–∞—Ç—å –∏–∑–º–µ–Ω–∏—Ç—å –ø–µ—Ä–∏–æ–¥ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

### 2. –ß–∞—Å—Ç–∏—á–Ω–æ –ø—É—Å—Ç—ã–µ –ø–µ—Ä–∏–æ–¥—ã
- –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å —Å–≤–æ–¥–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–∞–Ω–Ω—ã–º

### 3. –ü–µ—Ä–∏–æ–¥—ã —Å –¥–∞–Ω–Ω—ã–º–∏
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª–Ω—É—é –∞–Ω–∞–ª–∏—Ç–∏–∫—É
- –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏, —Ç–∞–±–ª–∏—Ü—ã –∏ —Å–≤–æ–¥–∫—É

## –¢—Ä–µ–±—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### Frontend Components

#### StorageAnalyticsPage
- –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ API
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ "no data available" –¥–ª—è –ø—É—Å—Ç—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤

#### StorageTrendsChart
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥" –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–∏–æ–¥—ã —Å –ø—Ä–æ–±–µ–ª–∞–º–∏

#### TopConsumersWidget
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è" –ø—Ä–∏ –ø—É—Å—Ç–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–µ—Ä–∏–æ–¥

#### StorageBySkuTable
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—É—Å—Ç–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
- –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –¥—Ä—É–≥–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞

### Backend API (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

#### /v1/analytics/storage/* endpoints
- –í–æ–∑–≤—Ä–∞—â–∞—Ç—å –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `data: []` –≤–º–µ—Å—Ç–æ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `has_data: false` –¥–ª—è –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è –ø—É—Å—Ç—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–µ—Ä–∏–æ–¥–∞ –∏ —Å–≤–æ–¥–∫–∏

## UI/UX –¢–µ–∫—Å—Ç—ã

### –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- "–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
- "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"
- "–í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–æ–π –ø–µ—Ä–∏–æ–¥ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏"

### –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ –¥–µ–π—Å—Ç–≤–∏—é
- "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏–π –ø–µ—Ä–∏–æ–¥"
- "–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∏–º–ø–æ—Ä—Ç WB API"
- "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –Ω–µ–¥–µ–ª–∏"

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Backend

### –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `has_data` –≤–æ –≤—Å–µ storage analytics endpoints

–í—Å–µ —Ç—Ä–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ `has_data: boolean`:

#### GET /v1/analytics/storage/by-sku
```typescript
// Response structure
{
  "period": { "from": "2025-W44", "to": "2025-W47", "days_count": 28 },
  "data": [...],
  "summary": {
    "total_storage_cost": 125000.0,
    "products_count": 150,
    "avg_cost_per_product": 833.33
  },
  "pagination": {
    "total": 150,
    "cursor": null,
    "has_more": false
  },
  "has_data": true  // üÜï –ù–û–í–û–ï –ü–û–õ–ï
}
```

#### GET /v1/analytics/storage/top-consumers
```typescript
// Response structure
{
  "period": { "from": "2025-W44", "to": "2025-W47", "days_count": 28 },
  "top_consumers": [...],
  "total_storage_cost": 28000.0,
  "has_data": true  // üÜï –ù–û–í–û–ï –ü–û–õ–ï
}
```

#### GET /v1/analytics/storage/trends
```typescript
// Response structure
{
  "period": { "from": "2025-W44", "to": "2025-W47", "days_count": 28 },
  "nm_id": null,
  "data": [...],
  "summary": { ... },
  "has_data": true  // üÜï –ù–û–í–û–ï –ü–û–õ–ï
}
```

### –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `has_data`

- **`true`**: –µ—Å–ª–∏ –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è > 0
- **`false`**: –µ—Å–ª–∏ –º–∞—Å—Å–∏–≤ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–æ–π –ò –æ–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å = 0

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### Frontend –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö
```typescript
// –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è empty states
const isEmptyPeriod = !response.has_data;
const hasData = response.has_data;

// –î–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å—Ç–∞—Ä—ã–º —Å–ø–æ—Å–æ–±–æ–º
const isEmptyLegacy = !response.data || response.data.length === 0;
```

### –ü—Ä–∏–º–µ—Ä—ã Empty State —Å–æ–æ–±—â–µ–Ω–∏–π

#### –ü–æ–ª–Ω–æ–µ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö
```typescript
if (!response.has_data) {
  return (
    <EmptyState
      title="–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç"
      message="–ù–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö –Ω–∞ –ø–ª–∞—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ"
      actions={[
        "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –±–æ–ª–µ–µ –ø–æ–∑–¥–Ω–∏–π –ø–µ—Ä–∏–æ–¥",
        "–ó–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –∏–º–ø–æ—Ä—Ç WB API",
        "–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –Ω–µ–¥–µ–ª–∏"
      ]}
    />
  );
}
```

#### –ß–∞—Å—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```typescript
if (response.has_data && response.pagination.total > response.data.length) {
  return (
    <WarningBanner>
      –ü–æ–∫–∞–∑–∞–Ω—ã {response.data.length} –∏–∑ {response.pagination.total} —Ç–æ–≤–∞—Ä–æ–≤.
      –í—ã–±–µ—Ä–∏—Ç–µ –¥—Ä—É–≥–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö.
    </WarningBanner>
  );
}
```

## –†–µ–∞–ª–∏–∑–∞—Ü–∏—è Backend

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. **Response DTOs** - –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `has_data: boolean`:
   - `src/analytics/dto/response/storage-by-sku-response.dto.ts`
   - `src/analytics/dto/response/storage-top-consumers-response.dto.ts`
   - `src/analytics/dto/response/storage-trends-response.dto.ts`

2. **Service Methods** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞:
   - `src/analytics/services/storage-analytics.service.ts`
   - –í—Å–µ —Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ (`getStorageBySku`, `getTopConsumers`, `getStorageTrends`)

### –õ–æ–≥–∏–∫–∞ `has_data`:

```typescript
// getStorageBySku
const hasData = responseData.length > 0 || totalStorageCost > 0;

// getTopConsumers
const hasData = topConsumers.length > 0 && totalStorageCost > 0;

// getStorageTrends
const hasData = dataPoints.length > 0;
```

## –°—Ç–∞—Ç—É—Å: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

–ë—ç–∫–µ–Ω–¥ —Ç–µ–ø–µ—Ä—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —á–µ—Ç–∫–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É:
- **–û—à–∏–±–∫–∞–º–∏ API** (HTTP 4xx/5xx) - –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—Ä–æ—Å–æ–º
- **–ü—É—Å—Ç—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏** (`has_data: false`) - –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –ë–î
- **–ù–∞–ª–∏—á–∏–µ–º –¥–∞–Ω–Ω—ã—Ö** (`has_data: true`) - –¥–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è

Frontend –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–µ `has_data` –¥–ª—è –ø–æ–∫–∞–∑–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö empty states –≤–º–µ—Å—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö.