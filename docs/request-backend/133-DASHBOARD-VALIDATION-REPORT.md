# Dashboard Data Validation Report

**Дата**: 2026-02-01
**Неделя**: 2026-W04 (19-25 января 2026)
**Статус**: ✅ ALL PASSED

---

## Резюме

Проведена полная валидация данных дашборда между frontend (localhost:3100) и backend API (localhost:3000).

**Результат: 12 из 12 проверок пройдено успешно.**

---

## Валидация данных за неделю 2026-W04

### Основные метрики

| Метрика | Frontend | Backend | API Field | Статус |
|---------|----------|---------|-----------|--------|
| **Выкупы** | 84 377,52 ₽ | 84 377,52 ₽ | `wb_sales_gross_total` | ✅ |
| **COGS выкупов** | 35 818 ₽ | 35 818 ₽ | `cogs_total` | ✅ |
| **Рекламные затраты** | 3 728,55 ₽ | 3 728,55 ₽ | `totalSpend` | ✅ |
| **Логистика** | 17 566,04 ₽ | 17 566,04 ₽ | `logistics_cost_total` | ✅ |
| **Хранение** | 2 024,94 ₽ | 2 024,94 ₽ | `storage_cost_total` | ✅ |
| **Теор. прибыль** | 25 239,99 ₽ | 25 239,99 ₽ | Расчётное | ✅ |

### Сравнение с предыдущей неделей (W03)

| Метрика | Frontend W03 | Backend W03 | Статус |
|---------|--------------|-------------|--------|
| **Выкупы** | 115 545,95 ₽ | 115 545,95 ₽ | ✅ |
| **COGS** | 46 293 ₽ | 46 293 ₽ | ✅ |
| **Реклама** | 6 138,7 ₽ | 6 138,70 ₽ | ✅ |
| **Логистика** | 27 207,53 ₽ | 27 207,53 ₽ | ✅ |
| **Хранение** | 2 046,3 ₽ | 2 046,30 ₽ | ✅ |

### Расчёт процентных изменений

| Метрика | Frontend Change | Calculated | Статус |
|---------|-----------------|------------|--------|
| Выкупы | -27.0% | -27.0% | ✅ |
| Реклама | -39.3% | -39.3% | ✅ |
| Логистика | -35.4% | -35.4% | ✅ |
| Хранение | -1.0% | -1.0% | ✅ |
| Теор. прибыль | -25.5% | -25.5% | ✅ |

---

## Маппинг полей API

### Finance Summary API
**Endpoint**: `GET /v1/analytics/weekly/finance-summary?week=2026-W04`

| Frontend метрика | Backend поле | Примечание |
|------------------|--------------|------------|
| Выкупы | `wb_sales_gross_total` | Выручка продавца после комиссии WB |
| COGS выкупов | `cogs_total` | Себестоимость проданных товаров |
| Логистика | `logistics_cost_total` | Затраты на логистику |
| Хранение | `storage_cost_total` | Затраты на хранение |

⚠️ **Важно**: Frontend использует `wb_sales_gross_total`, а НЕ `sale_gross_total`!

### Advertising API
**Endpoint**: `GET /v1/analytics/advertising?from=2026-01-19&to=2026-01-25`

| Frontend метрика | Backend поле |
|------------------|--------------|
| Рекламные затраты | `summary.totalSpend` |

### Заказы FBO/FBS
**Endpoints**:
- FBO: `GET /v1/orders/fbo?from=...&to=...`
- FBS: `GET /v1/orders?from=...&to=...`

| Карточка | Значение |
|----------|----------|
| Всего заказов | 22 |
| FBO | 19 (86.36%) |
| FBS | 3 (13.64%) |

---

## Формула теоретической прибыли

```
Теор. прибыль = wb_sales_gross - cogs - advertising - logistics - storage
```

**Расчёт для W04:**
```
= 84 377,52 - 35 818 - 3 728,55 - 17 566,04 - 2 024,94
= 25 239,99 ₽
```

**Файл реализации**: `frontend/src/lib/theoretical-profit.ts`

---

## Инструменты валидации

Созданы скрипты для повторной валидации:

```bash
# Валидация дашборда
E2E_TEST_EMAIL=test@test.com E2E_TEST_PASSWORD=Russia23! \
  npx tsx scripts/validate-dashboard-data-v2.ts
```

**Расположение скриптов**:
- `scripts/validate-dashboard-data.ts` - базовая валидация
- `scripts/validate-dashboard-data-v2.ts` - улучшенная версия с анализом

---

## Скриншот валидации

Dashboard был проверен визуально через Chrome browser automation.
Все значения на UI соответствуют данным API.

---

## Заключение

**Статус**: ✅ VALIDATION PASSED

Frontend команда корректно реализовала:
1. Отображение финансовых метрик
2. Расчёт теоретической прибыли
3. Сравнение с предыдущим периодом
4. Процентные изменения

**Расхождений не обнаружено.**

---

## Контакты

При обнаружении расхождений:
1. Запустите валидационные скрипты
2. Сравните с данными Swagger UI: http://localhost:3000/api
3. Создайте issue с тегом `dashboard-validation`

---

**Подготовлено**: Claude Code
**Дата проверки**: 2026-02-01
