# API Data Verification Summary

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ—Ç backend

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-11-21  
**Story 2.7:** Endpoint `available-weeks` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `weekly_payout_total` –≤–º–µ—Å—Ç–æ `imports`

---

## üìä –ê–Ω–∞–ª–∏–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ `available-weeks`

**Backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```json
{
  "data": [
    { "week": "2025-W46", "start_date": "2025-11-09" },
    { "week": "2025-W45", "start_date": "2025-11-02" }
  ]
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ `api-client.ts`:**
```typescript
// –°—Ç—Ä–æ–∫–∞ 105: return (data.data ?? data) as T
// –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç { data: [...] }, —Ç–æ:
// - data.data –±—É–¥–µ—Ç –º–∞—Å—Å–∏–≤–æ–º [...]
// - –í–µ—Ä–Ω–µ—Ç—Å—è –º–∞—Å—Å–∏–≤ –Ω–∞–ø—Ä—è–º—É—é
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤ hooks:**
```typescript
// useDashboard.ts:48
const weeksResponse = await apiClient.get<{ 
  data: Array<{ week: string; start_date: string }> 
}>('/v1/analytics/weekly/available-weeks')

// ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ï—Å–ª–∏ apiClient –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –Ω–∞–ø—Ä—è–º—É—é,
// —Ç–æ weeksResponse –±—É–¥–µ—Ç –º–∞—Å—Å–∏–≤–æ–º, –∞ –Ω–µ –æ–±—ä–µ–∫—Ç–æ–º { data: [...] }
// weeksResponse.data –±—É–¥–µ—Ç undefined!
```

**üî¥ –í–´–Ø–í–õ–ï–ù–ê –ü–†–û–ë–õ–ï–ú–ê:** –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –≤ `api-client.ts` –∏ –æ–∂–∏–¥–∞–Ω–∏—è–º–∏ –≤ hooks.

---

## üîß –†–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò–∑–º–µ–Ω–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ hooks (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

–ï—Å–ª–∏ `apiClient` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ –Ω–∞–ø—Ä—è–º—É—é, –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ hooks:

```typescript
// –¢–µ–∫—É—â–∏–π –∫–æ–¥ (–ù–ï–ü–†–ê–í–ò–õ–¨–ù–û):
const weeksResponse = await apiClient.get<{ 
  data: Array<{ week: string; start_date: string }> 
}>('/v1/analytics/weekly/available-weeks')
const weeks = weeksResponse?.data?.map((w) => w.week) || []

// –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥:
const weeksResponse = await apiClient.get<Array<{ week: string; start_date: string }>>(
  '/v1/analytics/weekly/available-weeks'
)
// apiClient –≤–µ—Ä–Ω–µ—Ç –º–∞—Å—Å–∏–≤ –Ω–∞–ø—Ä—è–º—É—é, –µ—Å–ª–∏ backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç { data: [...] }
const weeks = Array.isArray(weeksResponse) 
  ? weeksResponse.map((w) => w.week)
  : weeksResponse?.data?.map((w) => w.week) || []
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç backend:
- –ï—Å–ª–∏ `{ data: [...] }` ‚Üí `apiClient` –≤–µ—Ä–Ω–µ—Ç –º–∞—Å—Å–∏–≤ `[...]`
- –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ –º–∞—Å—Å–∏–≤ `[...]` ‚Üí `apiClient` –≤–µ—Ä–Ω–µ—Ç –º–∞—Å—Å–∏–≤ `[...]`

---

## üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ (DevTools)

1. –û—Ç–∫—Ä–æ–π—Ç–µ `http://localhost:3100/dashboard`
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network
3. –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `GET /v1/analytics/weekly/available-weeks`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Response:
   - –ï—Å–ª–∏ `{ data: [...] }` ‚Üí –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å hooks
   - –ï—Å–ª–∏ `[...]` ‚Üí hooks —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ:**
```
[Dashboard Metrics] Fetching finance summary for week: 2025-W46
[Dashboard Metrics] Finance summary received: { to_pay_goods: ..., sale_gross: ... }
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏:**
```
[Dashboard Metrics] No available weeks found...
```
‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `weeksResponse` –Ω–µ undefined

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞** –≤ Network tab –±—Ä–∞—É–∑–µ—Ä–∞
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å hooks**, –µ—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º
3. **–î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É** –æ—Ç –æ–±–æ–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ (–º–∞—Å—Å–∏–≤ –∏ –æ–±—ä–µ–∫—Ç)

---

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –æ—Ç–≤–µ—Ç–∞

